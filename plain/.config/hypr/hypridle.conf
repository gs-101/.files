# See https://wiki.hyprland.org/Hypr-Ecosystem/hypridle

$turn_off_screens = \
[ $XDG_CURRENT_DESKTOP = "Hyprland" ] && hyprctl dispatch dpms on && [ $XDG_CURRENT_DESKTOP ]
|| \
[ $XDG_CURRENT_DESKTOP = "niri" ] && niri msg

general {
  # Avoid starting multiple hyprlock instances.
  lock_cmd = pidof hyprlock || guix shell hyprlock -- hyprlock

  # Lock before suspending.
  before_sleep_cmd = loginctl lock-session

  # Avoid having to press a key twice to turn on the display.
  after_sleep_cmd = $turn_off_screens
}

listener {
  timeout = 600 # 10 minutes.

  # Set monitor backlight to minimum.
  on-timeout = brightnessctl -s set 10

  on-resume = brightnessctl -r
}

listener {
  timeout = 900 # 15 minutes.

  on-timeout = loginctl lock-session
}

listener {

  timeout = 1800 # 30 minutes.

  # Turn off screen.
  on-timeout = hyprctl dispatch dpms off

  # Turn on screen when activity is detected.
  on-resume = $turn_off_screens && brightnessctl -r
}
